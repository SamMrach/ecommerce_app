@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css" />


<link href="~/Content/themes/base/jquery-ui.min.css" rel="stylesheet" />

<script src="~/Scripts/jquery-3.1.1.min.js"></script>
<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
<script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>

<script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>


<div class="row ">
    <div class="col-sm-6">
        <h1>Tableau de bord </h1>
    </div>
</div>
<br />
<br />
<div class="row">
    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-info">
            <div class="inner">

                @{
                    ModelBD db = new ModelBD();
                    var nump = db.produits.ToList().Count();
                }
                <h3>@nump</h3>
                <p>Total produits</p>
            </div>
            <div class="icon                                                                                                                                            ">
                <i class="ion ion-bag"></i>
            </div>
            <a href='@Url.Action("Index","Produit")' class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-success">
            <div class="inner">

                @{
                    var revenue = db.commandes.ToList();
                    Double sum = 0;
                    foreach (var item in revenue)
                    {
                        sum += item.montant;
                    }
                }
                <h3>@sum MAD</h3>
                <p>Total Revenue</p>
            </div>
            <div class="icon">
                <i class="ion ion-stats-bars"></i>
            </div>
            <a href='@Url.Action("Index","Commande")' class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-warning">
            <div class="inner">
                @{
                    var NUMBER = db.clients.ToList().Count();
                }
                <h3>@NUMBER</h3>

                <p>Clients</p>
            </div>
            <div class="icon">
                <i class="ion ion-person-add"></i>
            </div>
            <a href='@Url.Action("Index","Client")' class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <!-- ./col -->

    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-danger">
            <div class="inner">
                @{
                    var NUM1 = db.proprietaires.ToList().Count();
                }
                <h3>@NUM1</h3>

                <p>Propriètaire</p>
            </div>
            <div class="icon">
                <i class="fas fa-user-tie"></i>
            </div>
            <a href='@Url.Action("Index","proprietaire")' class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xl-6 col-md-6">
        <div class="card table-card">
            <div class="card-header">
                <h5>Nouveaux Clients</h5>
                <div class="card-header-right">
                    <div class="btn-group card-option">

                        <ul class="list-unstyled card-option dropdown-menu dropdown-menu-right">
                            <li class="dropdown-item full-card"><a href="#!"><span><i class="feather icon-maximize"></i> maximize</span><span style="display:none"><i class="feather icon-minimize"></i> Restore</span></a></li>
                            <li class="dropdown-item minimize-card"><a href="#!"><span><i class="feather icon-minus"></i> collapse</span><span style="display:none"><i class="feather icon-plus"></i> expand</span></a></li>
                            <li class="dropdown-item reload-card"><a href="#!"><i class="feather icon-refresh-cw"></i> reload</a></li>
                            <li class="dropdown-item close-card"><a href="#!"><i class="feather icon-trash"></i> remove</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="card-body p-0 m-2">

                <div class=" tablecontainer1 table-responsive">
                    <table id="myDatatable1" class="table table-striped table-bordered">
                        <thead>
                            <tr>

                                <th>Nom</th>
                                <th>Prenom</th>
                                <th>Email</th>
                                <th>Telephone</th>
                            </tr>
                        </thead>

                    </table>
                </div>
            </div>
            </div>
        </div>
   

    <div class="col-xl-6 col-md-6">
        <div class="card table-card">
            <div class="card-header">
                <h5>Nouveaux Propriètaires</h5>
                <div class="card-header-right">
                    <div class="btn-group card-option">

                        <ul class="list-unstyled card-option dropdown-menu dropdown-menu-right">
                            <li class="dropdown-item full-card"><a href="#!"><span><i class="feather icon-maximize"></i> maximize</span><span style="display:none"><i class="feather icon-minimize"></i> Restore</span></a></li>
                            <li class="dropdown-item minimize-card"><a href="#!"><span><i class="feather icon-minus"></i> collapse</span><span style="display:none"><i class="feather icon-plus"></i> expand</span></a></li>
                            <li class="dropdown-item reload-card"><a href="#!"><i class="feather icon-refresh-cw"></i> reload</a></li>
                            <li class="dropdown-item close-card"><a href="#!"><i class="feather icon-trash"></i> remove</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="card-body p-0 m-2">

                <div class=" tablecontainer1 table-responsive">
                    <table id="myDatatable" class="table table-striped table-bordered">
                        <thead>
                            <tr>

                                <th>Nom</th>
                                <th>Prenom</th>
                                <th>Email</th>
                                <th>Telephone</th>
                            </tr>
                        </thead>

                    </table>
                </div>
                <script>
                   
                        $(document).ready(function () {
                                            var oTable = $('#myDatatable').DataTable({
                            "ajax": {
                            "url": '/Home/GetProprietaire',
                                                    "type": "get",
                                                    "datatype": "json"
                                                },
                                                "columns": [

                                                    {"data": "nom", "autoWidth": true },
                                                    {"data": "prenom", "autoWidth": true },
                                                    {"data": "email", "autoWidth": true },
                                                    {"data": "tel", "autoWidth": true }
                                                ]
                                            })
                                                         $('.tablecontainer').on('click', 'a.popup', function (e) {
                            e.preventDefault();
                                                OpenPopup($(this).attr('href'));
                                            })
                                            function OpenPopup(pageUrl) {
                                                var $pageContent = $('<div />');
                                                $pageContent.load(pageUrl, function () {
                            $('#popupForm', $pageContent).removeData('validator');
                                                    $('#popupForm', $pageContent).removeData('unobtrusiveValidation');
                                                    $.validator.unobtrusive.parse('form');

                                                });

                                                $dialog = $('<div class="popupWindow" style="overflow:auto"></div>')
                                                    .html($pageContent)
                                                    .dialog({
                            draggable: false,
                                                        autoOpen: false,
                                                        resizable: false,
                                                        model: true,
                                                        title: 'Popup Dialog',
                                                        height: 560,
                                                        width: 600,
                                                        close: function () {
                            $dialog.dialog('destroy').remove();
                                                        }
                                                    })

                                                $('.popupWindow').on('submit', '#popupForm', function (e) {
                                                    var url = $('#popupForm')[0].action;
                                                    $.ajax({
                            type: "POST",
                                                        url: url,
                                                        data: $('#popupForm').serialize(),
                                                        success: function (data) {
                                                            if (data.status) {
                            $dialog.dialog('close');
                                                                oTable.ajax.reload();
                                                                //$.notify(data.message, {
                            //    globalPosition: "top center",
                            //    className: "success"
                            //})
                        }
                                                        }
                                                    })

                                                    e.preventDefault();
                                                })

                                                $dialog.dialog('open');
                            }
                            var oTable = $('#myDatatable1').DataTable({
                            "ajax": {
                                "url": '/Home/GetClient',
                                "type": "get",
                                "datatype": "json"
                            },
                            "columns": [

                                { "data": "nom", "autoWidth": true },
                                { "data": "prenom", "autoWidth": true },
                                { "data": "email", "autoWidth": true },
                                { "data": "tel", "autoWidth": true }
                            ]
                        })
                        $('.tablecontainer1').on('click', 'a.popup', function (e) {
                            e.preventDefault();
                            OpenPopup($(this).attr('href'));
                        })
                        })
                    //$(document).ready(function () {
                    //    var oTable = $('#myDatatable1').DataTable({
                    //        "ajax": {
                    //            "url": '/Home/GetClient',
                    //            "type": "get",
                    //            "datatype": "json"
                    //        },
                    //        "columns": [

                    //            { "data": "nom", "autoWidth": true },
                    //            { "data": "prenom", "autoWidth": true },
                    //            { "data": "email", "autoWidth": true },
                    //            { "data": "tel", "autoWidth": true }
                    //        ]
                    //    })
                    //    $('.tablecontainer1').on('click', 'a.popup', function (e) {
                    //        e.preventDefault();
                    //        OpenPopup($(this).attr('href'));
                    //    })
                </script>
            </div>
            </div>
        </div>
    </div>
    <!-- ./col -->
</div>
<!-- /.row -->
<!-- Main row -->
<div class="row">
    <!-- Left col -->
    <section class="col-lg-7 connectedSortable">
        <!-- Custom tabs (Charts with tabs)-->
        <!-- /.card -->
        <!-- DIRECT CHAT -->
        <!--/.direct-chat -->
        <!-- TO DO List -->
        <!-- /.card -->
    </section>
    <!-- /.Left col -->
    <!-- right col (We are only adding the ID to make the widgets sortable)-->
    <section class="col-lg-5 connectedSortable">

        <!-- Map card -->
        <!-- /.card -->
        <!-- solid sales graph -->
        <!-- /.card -->
    </section>
    <!-- right col -->
</div>


